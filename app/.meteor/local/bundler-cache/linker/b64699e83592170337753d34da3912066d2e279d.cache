[{"type":"js","data":"//////////////////////////////////////////////////////////////////////////\n//                                                                      //\n// This is a generated file. You can view the original                  //\n// source in your browser if your browser supports source maps.         //\n// Source maps are supported by all recent versions of Chrome, Safari,  //\n// and Firefox, and by Internet Explorer 11.                            //\n//                                                                      //\n//////////////////////////////////////////////////////////////////////////\n\n\n(function () {\n\n/* Imports */\nvar Meteor = Package.meteor.Meteor;\nvar global = Package.meteor.global;\nvar meteorEnv = Package.meteor.meteorEnv;\nvar _ = Package.underscore._;\nvar Mongo = Package.mongo.Mongo;\nvar HTTP = Package.http.HTTP;\nvar Spacebars = Package.spacebars.Spacebars;\nvar Template = Package['templating-runtime'].Template;\nvar Tracker = Package.tracker.Tracker;\nvar Deps = Package.tracker.Deps;\nvar BigNumber = Package['ethereum:web3'].BigNumber;\nvar Web3 = Package['ethereum:web3'].Web3;\nvar PersistentMinimongo = Package['frozeman:persistent-minimongo'].PersistentMinimongo;\nvar LocalStore = Package['frozeman:storage'].LocalStore;\nvar Blaze = Package.blaze.Blaze;\nvar UI = Package.blaze.UI;\nvar Handlebars = Package.blaze.Handlebars;\nvar HTML = Package.htmljs.HTML;\n\n/* Package-scope variables */\nvar EthTools, optionalLength, options;\n\n(function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/ethereum_tools/ethtools.js                                                                                 //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n/**                                                                                                                    // 1\nTemplate Controllers                                                                                                   // 2\n                                                                                                                       // 3\n@module Packages                                                                                                       // 4\n*/                                                                                                                     // 5\n                                                                                                                       // 6\n                                                                                                                       // 7\n/**                                                                                                                    // 8\nHelper functions for ethereum dapps                                                                                    // 9\n                                                                                                                       // 10\n@class [packages] ethereum:tools                                                                                       // 11\n@constructor                                                                                                           // 12\n*/                                                                                                                     // 13\n                                                                                                                       // 14\nvar isMeteorPackage = true;                                                                                            // 15\n                                                                                                                       // 16\n// setup LocalStore if not available                                                                                   // 17\nif(typeof LocalStore === 'undefined') {                                                                                // 18\n    isMeteorPackage = false;                                                                                           // 19\n    LocalStore = {                                                                                                     // 20\n        get: function(){},                                                                                             // 21\n        set: function(){}                                                                                              // 22\n    };                                                                                                                 // 23\n}                                                                                                                      // 24\n                                                                                                                       // 25\n// stup Tracker if not available                                                                                       // 26\nif(typeof Tracker === 'undefined')                                                                                     // 27\n    Tracker = {                                                                                                        // 28\n        Dependency: function(){                                                                                        // 29\n            return {                                                                                                   // 30\n                depend: function(){},                                                                                  // 31\n                changed: function(){}                                                                                  // 32\n            }                                                                                                          // 33\n        }                                                                                                              // 34\n    };                                                                                                                 // 35\n                                                                                                                       // 36\nvar dependency = new Tracker.Dependency;                                                                               // 37\n                                                                                                                       // 38\n/**                                                                                                                    // 39\nCheck for supported currencies                                                                                         // 40\n                                                                                                                       // 41\n@method supportedCurrencies                                                                                            // 42\n@param {String} unit                                                                                                   // 43\n@return {String}                                                                                                       // 44\n*/                                                                                                                     // 45\nvar supportedCurrencies = function(unit){                                                                              // 46\n    return (unit === 'usd' ||                                                                                          // 47\n           unit === 'eur' ||                                                                                           // 48\n           unit === 'btc');                                                                                            // 49\n};                                                                                                                     // 50\n                                                                                                                       // 51\n/**                                                                                                                    // 52\nGets the ether unit if not set from localstorage                                                                       // 53\n                                                                                                                       // 54\n@method getUnit                                                                                                        // 55\n@param {String} unit                                                                                                   // 56\n@return {String}                                                                                                       // 57\n*/                                                                                                                     // 58\nvar getUnit = function(unit){                                                                                          // 59\n    if(!_.isString(unit)) {                                                                                            // 60\n        unit = LocalStore.get('dapp_etherUnit');                                                                       // 61\n                                                                                                                       // 62\n        if(!unit) {                                                                                                    // 63\n            unit = 'ether';                                                                                            // 64\n            LocalStore.set('dapp_etherUnit', unit);                                                                    // 65\n        }                                                                                                              // 66\n    }                                                                                                                  // 67\n                                                                                                                       // 68\n    return unit;                                                                                                       // 69\n};                                                                                                                     // 70\n                                                                                                                       // 71\n                                                                                                                       // 72\n                                                                                                                       // 73\n/**                                                                                                                    // 74\nHelper functions for ethereum dapps                                                                                    // 75\n                                                                                                                       // 76\n@class EthTools                                                                                                        // 77\n@constructor                                                                                                           // 78\n*/                                                                                                                     // 79\n                                                                                                                       // 80\nEthTools = {                                                                                                           // 81\n    lang: 'en'                                                                                                         // 82\n};                                                                                                                     // 83\n                                                                                                                       // 84\nif(isMeteorPackage) {                                                                                                  // 85\n                                                                                                                       // 86\n    /**                                                                                                                // 87\n    Sets the default unit used by all EthTools functions, if no unit is provided.                                      // 88\n                                                                                                                       // 89\n        EthTools.setUnit('ether')                                                                                      // 90\n                                                                                                                       // 91\n    @method setUnit                                                                                                    // 92\n    @param {String} unit the unit like 'ether', or 'eur'                                                               // 93\n    @param {Boolean}                                                                                                   // 94\n    **/                                                                                                                // 95\n    EthTools.setUnit = function(unit){                                                                                 // 96\n        if(supportedCurrencies(unit)) {                                                                                // 97\n            LocalStore.set('dapp_etherUnit', unit);                                                                    // 98\n            return true;                                                                                               // 99\n        } else {                                                                                                       // 100\n            try {                                                                                                      // 101\n                web3.toWei(1, unit);                                                                                   // 102\n                LocalStore.set('dapp_etherUnit', unit);                                                                // 103\n                return true;                                                                                           // 104\n            } catch(e) {                                                                                               // 105\n                return false;                                                                                          // 106\n            }                                                                                                          // 107\n        }                                                                                                              // 108\n    };                                                                                                                 // 109\n                                                                                                                       // 110\n    /**                                                                                                                // 111\n    Get the default unit used by all EthTools functions, if no unit is provided.                                       // 112\n                                                                                                                       // 113\n        EthTools.getUnit()                                                                                             // 114\n                                                                                                                       // 115\n    @method getUnit                                                                                                    // 116\n    @return {String} unit the unit like 'ether', or 'eur'                                                              // 117\n    **/                                                                                                                // 118\n    EthTools.getUnit = function(){                                                                                     // 119\n        return LocalStore.get('dapp_etherUnit');                                                                       // 120\n    };                                                                                                                 // 121\n}                                                                                                                      // 122\n                                                                                                                       // 123\n/**                                                                                                                    // 124\nSets the locale to display numbers in different formats.                                                               // 125\n                                                                                                                       // 126\n    EthTools.setLocale('de')                                                                                           // 127\n                                                                                                                       // 128\n@method language                                                                                                       // 129\n@param {String} lang the locale like \"de\" or \"de-DE\"                                                                   // 130\n**/                                                                                                                    // 131\nEthTools.setLocale = function(lang){                                                                                   // 132\n    var lang = lang.substr(0,2).toLowerCase();                                                                         // 133\n    // numeral.language(lang);                                                                                         // 134\n    EthTools.lang = lang;                                                                                              // 135\n                                                                                                                       // 136\n    dependency.changed();                                                                                              // 137\n                                                                                                                       // 138\n    return lang;                                                                                                       // 139\n};                                                                                                                     // 140\n                                                                                                                       // 141\n/**                                                                                                                    // 142\nFormats a given number                                                                                                 // 143\n                                                                                                                       // 144\n    EthTools.formatNumber(10000, \"0.0[000]\")                                                                           // 145\n                                                                                                                       // 146\n@method formatNumber                                                                                                   // 147\n@param {Number|String|BigNumber} number the number to format                                                           // 148\n@param {String} format           the format string e.g. \"0,0.0[000]\" see http://numeraljs.com for more.                // 149\n@return {String} The formated time                                                                                     // 150\n**/                                                                                                                    // 151\nEthTools.formatNumber = function(number, format){                                                                      // 152\n    var length = optionalLength = 0;                                                                                   // 153\n    dependency.depend();                                                                                               // 154\n                                                                                                                       // 155\n    if(!_.isFinite(number) && !(number instanceof BigNumber))                                                          // 156\n        number = 0;                                                                                                    // 157\n                                                                                                                       // 158\n    if(format instanceof Spacebars.kw)                                                                                 // 159\n        format = null;                                                                                                 // 160\n                                                                                                                       // 161\n    if(_.isString(number))                                                                                             // 162\n        number = new BigNumber(number, 10);                                                                            // 163\n    if(_.isFinite(number) && !_.isObject(number))                                                                      // 164\n        number = new BigNumber(number);                                                                                // 165\n                                                                                                                       // 166\n    options = (EthTools.lang === 'en')                                                                                 // 167\n        ?   { decimalSeparator: '.',                                                                                   // 168\n              groupSeparator: ',',                                                                                     // 169\n              groupSize: 3                                                                                             // 170\n            }                                                                                                          // 171\n        :   { decimalSeparator: ',',                                                                                   // 172\n              groupSeparator: ' ',                                                                                     // 173\n              groupSize: 3                                                                                             // 174\n            };                                                                                                         // 175\n    BigNumber.config({ FORMAT: options });                                                                             // 176\n                                                                                                                       // 177\n                                                                                                                       // 178\n    // get segment positions (0,0. | 0 | [0])                                                                          // 179\n    if(format && ~format.indexOf('.')) {                                                                               // 180\n        var decimalPos = format.indexOf('.');                                                                          // 181\n        if(~format.indexOf('[')) {                                                                                     // 182\n            length = format.substr(decimalPos, format.indexOf('[') - decimalPos).replace(/[\\.\\[\\]]/g,'').length;       // 183\n            optionalLength = format.substr(format.indexOf('[')).replace(/[\\[\\]]/g,'').length;                          // 184\n        } else {                                                                                                       // 185\n            length = format.substr(decimalPos).replace(/[\\.\\[\\]]/g,'').length;                                         // 186\n            optionalLength = 0;                                                                                        // 187\n        }                                                                                                              // 188\n    }                                                                                                                  // 189\n    var fullLength = length + optionalLength;                                                                          // 190\n    number = number.toFormat(fullLength ? fullLength : undefined);                                                     // 191\n                                                                                                                       // 192\n    // if segements are detected, rebuild the number string                                                            // 193\n    if(fullLength) {                                                                                                   // 194\n        var beforeDecimal = number.substr(0, number.indexOf(options.decimalSeparator) + 1);                            // 195\n        var afterDecimal = number.replace(beforeDecimal, '').substr(0, length);                                        // 196\n        var afterDecimalOptional = number.replace(beforeDecimal, '').substr(length, optionalLength).replace(/0*$/,'');\n        beforeDecimal = beforeDecimal.replace(options.decimalSeparator, '');                                           // 198\n                                                                                                                       // 199\n        return (!afterDecimal && !afterDecimalOptional)                                                                // 200\n            ? beforeDecimal                                                                                            // 201\n            : beforeDecimal + options.decimalSeparator + afterDecimal + afterDecimalOptional;                          // 202\n                                                                                                                       // 203\n    // otherwise simply return the formated number                                                                     // 204\n    } else {                                                                                                           // 205\n        return number;                                                                                                 // 206\n    }                                                                                                                  // 207\n};                                                                                                                     // 208\n                                                                                                                       // 209\n/**                                                                                                                    // 210\nFormats a number of wei to a balance.                                                                                  // 211\n                                                                                                                       // 212\n    EthTools.formatBalance(myNumber, \"0,0.0[0000] unit\")                                                               // 213\n                                                                                                                       // 214\n@method (formatBalance)                                                                                                // 215\n@param {String} number                                                                                                 // 216\n@param {String} format       the format string                                                                         // 217\n@return {String} The formatted number                                                                                  // 218\n**/                                                                                                                    // 219\nEthTools.formatBalance = function(number, format, unit){                                                               // 220\n    dependency.depend();                                                                                               // 221\n                                                                                                                       // 222\n    if(!_.isFinite(number) && !(number instanceof BigNumber))                                                          // 223\n        number = 0;                                                                                                    // 224\n                                                                                                                       // 225\n    if(format instanceof Spacebars.kw)                                                                                 // 226\n        format = null;                                                                                                 // 227\n                                                                                                                       // 228\n    format = format || '0,0.[00000000]';                                                                               // 229\n                                                                                                                       // 230\n    unit = getUnit(unit);                                                                                              // 231\n                                                                                                                       // 232\n    if(typeof EthTools.ticker !== 'undefined' && supportedCurrencies(unit)) {                                          // 233\n        var ticker = EthTools.ticker.findOne(unit, {fields: {price: 1}});                                              // 234\n                                                                                                                       // 235\n        // convert first to ether                                                                                      // 236\n        number = web3.fromWei(number, 'ether');                                                                        // 237\n                                                                                                                       // 238\n        // then times the currency                                                                                     // 239\n        if(ticker) {                                                                                                   // 240\n            number = (number instanceof BigNumber || _.isObject(number))                                               // 241\n                ? number.times(ticker.price)                                                                           // 242\n                : new BigNumber(String(number), 10).times(ticker.price);                                               // 243\n                                                                                                                       // 244\n        } else {                                                                                                       // 245\n            number = '0';                                                                                              // 246\n        }                                                                                                              // 247\n                                                                                                                       // 248\n    } else {                                                                                                           // 249\n        number = web3.fromWei(number, unit.toLowerCase());                                                             // 250\n    }                                                                                                                  // 251\n                                                                                                                       // 252\n    var isUppercase = (format.indexOf('UNIT') !== -1);                                                                 // 253\n                                                                                                                       // 254\n    var cleanedFormat = format.replace(/ *unit */i,'').replace(/ +/,'');                                               // 255\n    var format = format.replace(cleanedFormat, '__format__');                                                          // 256\n                                                                                                                       // 257\n    if(format.toLowerCase().indexOf('unit') !== -1) {                                                                  // 258\n        return format.replace('__format__', EthTools.formatNumber(number, cleanedFormat)).replace(/unit/i, (isUppercase ? unit.toUpperCase() : unit));\n    } else                                                                                                             // 260\n        return EthTools.formatNumber(number, cleanedFormat);                                                           // 261\n};                                                                                                                     // 262\n                                                                                                                       // 263\n                                                                                                                       // 264\n/**                                                                                                                    // 265\nFormats any of the supported currency to ethereum wei.                                                                 // 266\n                                                                                                                       // 267\n    EthTools.toWei(myNumber, unit)                                                                                     // 268\n                                                                                                                       // 269\n@method (toWei)                                                                                                        // 270\n@param {String} number                                                                                                 // 271\n@return {String} unit                                                                                                  // 272\n**/                                                                                                                    // 273\nEthTools.toWei = function(number, unit){                                                                               // 274\n                                                                                                                       // 275\n    if(!_.isFinite(number) && !(number instanceof BigNumber))                                                          // 276\n        return number;                                                                                                 // 277\n                                                                                                                       // 278\n    unit = getUnit(unit);                                                                                              // 279\n                                                                                                                       // 280\n    if(typeof EthTools.ticker !== 'undefined' && supportedCurrencies(unit)) {                                          // 281\n        var ticker = EthTools.ticker.findOne(unit, {fields: {price: 1}});                                              // 282\n                                                                                                                       // 283\n        // convert first to ether                                                                                      // 284\n        number = web3.toWei(number, 'ether');                                                                          // 285\n                                                                                                                       // 286\n        // then times the currency                                                                                     // 287\n        if(ticker) {                                                                                                   // 288\n            number = (number instanceof BigNumber || _.isObject(number))                                               // 289\n                ? number.dividedBy(ticker.price)                                                                       // 290\n                : new BigNumber(String(number), 10).dividedBy(ticker.price);                                           // 291\n                                                                                                                       // 292\n            // make sure the number is flat                                                                            // 293\n            number = number.round(0).toString(10);                                                                     // 294\n        } else {                                                                                                       // 295\n            number = '0';                                                                                              // 296\n        }                                                                                                              // 297\n                                                                                                                       // 298\n    } else {                                                                                                           // 299\n        number = web3.toWei(number, unit.toLowerCase());                                                               // 300\n                                                                                                                       // 301\n    }                                                                                                                  // 302\n                                                                                                                       // 303\n    return number;                                                                                                     // 304\n};                                                                                                                     // 305\n                                                                                                                       // 306\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/ethereum_tools/ticker.js                                                                                   //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n// Price ticker                                                                                                        // 1\nEthTools.ticker = new Mongo.Collection('ethereum_price_ticker', {connection: null});                                   // 2\nif(Meteor.isClient)                                                                                                    // 3\n    new PersistentMinimongo(EthTools.ticker);                                                                          // 4\n                                                                                                                       // 5\nEthTools.ticker.start = function(options){                                                                             // 6\n    var url = 'https://min-api.cryptocompare.com/data/price?fsym=ETH&tsyms=BTC,USD,EUR';                               // 7\n                                                                                                                       // 8\n    options = options || {};                                                                                           // 9\n                                                                                                                       // 10\n    if(options.extraParams)                                                                                            // 11\n        url += '&extraParams='+ options.extraParams;                                                                   // 12\n                                                                                                                       // 13\n    var updatePrice = function(e, res){                                                                                // 14\n                                                                                                                       // 15\n        if(!e && res && res.statusCode === 200) {                                                                      // 16\n            var content = JSON.parse(res.content);                                                                     // 17\n                                                                                                                       // 18\n            if(content){                                                                                               // 19\n                _.each(content, function(price, key){                                                                  // 20\n                    var name = key.toLowerCase();                                                                      // 21\n                                                                                                                       // 22\n                    // make sure its a number and nothing else!                                                        // 23\n                    if(_.isFinite(price)) {                                                                            // 24\n                        EthTools.ticker.upsert(name, {$set: {                                                          // 25\n                            price: String(price),                                                                      // 26\n                            timestamp: null                                                                            // 27\n                        }});                                                                                           // 28\n                    }                                                                                                  // 29\n                                                                                                                       // 30\n                });                                                                                                    // 31\n            }                                                                                                          // 32\n        } else {                                                                                                       // 33\n            console.warn('Can not connect to https://mini-api.cryptocompare.com to get price ticker data, please check your internet connection.');\n        }                                                                                                              // 35\n    };                                                                                                                 // 36\n                                                                                                                       // 37\n    // update right away                                                                                               // 38\n    HTTP.get(url, updatePrice);                                                                                        // 39\n                                                                                                                       // 40\n    // update prices                                                                                                   // 41\n    Meteor.setInterval(function(){                                                                                     // 42\n        HTTP.get(url, updatePrice);                                                                                    // 43\n    }, 1000 * 30);                                                                                                     // 44\n}                                                                                                                      // 45\n                                                                                                                       // 46\n                                                                                                                       // 47\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/ethereum_tools/globalHelpers.js                                                                            //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n/**                                                                                                                    // 1\nFormats a number.                                                                                                      // 2\n                                                                                                                       // 3\n    {{dapp_formatNumber myNumber \"0,0.0[0000]\"}}                                                                       // 4\n                                                                                                                       // 5\n@method (dapp_formatNumber)                                                                                            // 6\n@param {String} number                                                                                                 // 7\n@param {String} format       the format string                                                                         // 8\n@return {String} The formatted number                                                                                  // 9\n**/                                                                                                                    // 10\nTemplate.registerHelper('dapp_formatNumber', EthTools.formatNumber);                                                   // 11\n                                                                                                                       // 12\n/**                                                                                                                    // 13\nFormats a number.                                                                                                      // 14\n                                                                                                                       // 15\n    {{dapp_formatBalance myNumber \"0,0.0[0000]\"}}                                                                      // 16\n                                                                                                                       // 17\n@method (dapp_formatBalance)                                                                                           // 18\n@param {String} number                                                                                                 // 19\n@param {String} format       the format string                                                                         // 20\n@return {String} The formatted number                                                                                  // 21\n**/                                                                                                                    // 22\nTemplate.registerHelper('dapp_formatBalance', EthTools.formatBalance);                                                 // 23\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n/* Exports */\nif (typeof Package === 'undefined') Package = {};\n(function (pkg, symbols) {\n  for (var s in symbols)\n    (s in pkg) || (pkg[s] = symbols[s]);\n})(Package['ethereum:tools'] = {}, {\n  EthTools: EthTools\n});\n\n})();\n","servePath":"/packages/ethereum_tools.js"}]